{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "description": "Dashboard for Power Monitor",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 4,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays the current total power consumption across all nodes in the cluster measured in watts. This includes both active workload power and idle power from all available measurement zones (psys, package, and dram).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "#6ED0E0",
                "value": 200
              },
              {
                "color": "#EAB839",
                "value": 500
              },
              {
                "color": "#EF843C",
                "value": 800
              },
              {
                "color": "#E24D42",
                "value": 1000
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 7,
        "x": 0,
        "y": 0
      },
      "id": 216,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# 1. Sum 'psys' from nodes that HAVE 'psys'\n(sum(\n  kepler_node_cpu_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 2. Sum 'package' from nodes that DO NOT HAVE 'psys'\n(sum(\n  kepler_node_cpu_watts{zone=\"package\"}\n  unless on(node_name)\n  kepler_node_cpu_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 3. Sum 'dram' from ALL nodes that have it\n(sum(\n  kepler_node_cpu_watts{zone=\"dram\"}\n) or vector(0))",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Total Cluster Power",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows the power consumed by actively running workloads and processes across the cluster. This represents the power directly attributable to computational work being performed.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "light-green",
                "value": 100
              },
              {
                "color": "#EAB839",
                "value": 300
              },
              {
                "color": "#E24D42",
                "value": 500
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 7,
        "y": 0
      },
      "id": 217,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# 1. Sum 'psys' from nodes that HAVE 'psys'\n(sum(\n  kepler_node_cpu_active_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 2. Sum 'package' from nodes that DO NOT HAVE 'psys'\n(sum(\n  kepler_node_cpu_active_watts{zone=\"package\"}\n  unless on(node_name)\n  kepler_node_cpu_active_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 3. Sum 'dram' from ALL nodes that have it\n(sum(\n  kepler_node_cpu_active_watts{zone=\"dram\"}\n) or vector(0))",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Active Workload Power",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays the baseline power consumption of idle cluster resources. This represents the power consumed by nodes even when they are not actively processing workloads.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 13,
        "y": 0
      },
      "id": 218,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# 1. Sum 'psys' from nodes that HAVE 'psys'\n(sum(\n  kepler_node_cpu_idle_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 2. Sum 'package' from nodes that DO NOT HAVE 'psys'\n(sum(\n  kepler_node_cpu_idle_watts{zone=\"package\"}\n  unless on(node_name)\n  kepler_node_cpu_idle_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 3. Sum 'dram' from ALL nodes that have it\n(sum(\n  kepler_node_cpu_idle_watts{zone=\"dram\"}\n) or vector(0))",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Idle Resource Power",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows the percentage of total cluster power being used for active work versus idle consumption. Higher values indicate better efficiency, with more power being used for actual workloads rather than idle overhead.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 30
              },
              {
                "color": "light-green",
                "value": 50
              },
              {
                "color": "green",
                "value": 70
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 5,
        "x": 19,
        "y": 0
      },
      "id": 219,
      "options": {
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "sizing": "auto"
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "100 * (\n  (\n    (sum(kepler_node_cpu_active_watts{job=\"$job\", zone=\"psys\"}) or vector(0)) +\n    (sum(kepler_node_cpu_active_watts{job=\"$job\", zone=\"package\"} unless on(node_name) kepler_node_cpu_active_watts{job=\"$job\", zone=\"psys\"}) or vector(0)) +\n    (sum(kepler_node_cpu_active_watts{job=\"$job\", zone=\"dram\"}) or vector(0))\n  ) / (\n    (sum(kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}) or vector(0)) +\n    (sum(kepler_node_cpu_watts{job=\"$job\", zone=\"package\"} unless on(node_name) kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}) or vector(0)) +\n    (sum(kepler_node_cpu_watts{job=\"$job\", zone=\"dram\"}) or vector(0))\n  )\n)",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Power Efficiency",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays the count of cluster nodes that are currently being monitored by Kepler for power consumption metrics. These are the nodes actively reporting power data.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 8,
        "x": 0,
        "y": 5
      },
      "id": 213,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "count(count by (instance)(kepler_node_cpu_info))",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Active Nodes",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows the count of cluster nodes that are ready but not currently monitored by Kepler. These nodes may not have Kepler installed or configured properly.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 8,
        "x": 8,
        "y": 5
      },
      "id": 214,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "count(kube_node_status_condition{condition=\"Ready\",status=\"true\"}) - count(count by (instance)(kepler_node_cpu_info))",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Inactive nodes",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays the number of Kubernetes namespaces that have workloads currently being monitored for power consumption by Kepler.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 8,
        "x": 16,
        "y": 5
      },
      "id": 215,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "count(count by (pod_namespace) (kepler_pod_cpu_watts))",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Active Namespaces/Workload",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays a time-series graph showing how cluster power consumption has changed over time. The graph breaks down power into three categories: total power, active workload power, and idle power, allowing you to see trends and patterns in energy usage.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 24,
        "x": 0,
        "y": 10
      },
      "id": 222,
      "options": {
        "legend": {
          "calcs": ["last", "mean"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# 1. Sum 'psys' from nodes that HAVE 'psys'\n(sum(\n  kepler_node_cpu_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 2. Sum 'package' from nodes that DO NOT HAVE 'psys'\n(sum(\n  kepler_node_cpu_watts{zone=\"package\"}\n  unless on(node_name)\n  kepler_node_cpu_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 3. Sum 'dram' from ALL nodes that have it\n(sum(\n  kepler_node_cpu_watts{zone=\"dram\"}\n) or vector(0))",
          "instant": false,
          "legendFormat": "Total Power",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# 1. Sum 'psys' from nodes that HAVE 'psys'\n(sum(\n  kepler_node_cpu_active_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 2. Sum 'package' from nodes that DO NOT HAVE 'psys'\n(sum(\n  kepler_node_cpu_active_watts{zone=\"package\"}\n  unless on(node_name)\n  kepler_node_cpu_active_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 3. Sum 'dram' from ALL nodes that have it\n(sum(\n  kepler_node_cpu_active_watts{zone=\"dram\"}\n) or vector(0))",
          "hide": false,
          "instant": false,
          "legendFormat": "Active Power",
          "range": true,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# 1. Sum 'psys' from nodes that HAVE 'psys'\n(sum(\n  kepler_node_cpu_idle_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 2. Sum 'package' from nodes that DO NOT HAVE 'psys'\n(sum(\n  kepler_node_cpu_idle_watts{zone=\"package\"}\n  unless on(node_name)\n  kepler_node_cpu_idle_watts{zone=\"psys\"}\n) or vector(0))\n+\n# 3. Sum 'dram' from ALL nodes that have it\n(sum(\n  kepler_node_cpu_idle_watts{zone=\"dram\"}\n) or vector(0))",
          "hide": false,
          "instant": false,
          "legendFormat": "Idle Power",
          "range": true,
          "refId": "C"
        }
      ],
      "title": "Cluster Power Consumption Trend",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 22
      },
      "id": 211,
      "panels": [],
      "title": "Hardware Power Measurement Capabilities",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Lists the hardware power measurement capabilities (RAPL zones) available on each node. Common zones include psys (platform/SoC power), package (CPU package power), and dram (memory power). This helps identify which nodes can provide which types of power measurements.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 23
      },
      "id": 212,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": ["sum"],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "group by (node_name,zone)(kepler_node_cpu_watts{job=\"$job\"})",
          "format": "table",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Available RAPL Zones by Node",
      "transformations": [
        {
          "id": "labelsToFields",
          "options": {
            "mode": "columns"
          }
        },
        {
          "id": "groupBy",
          "options": {
            "fields": {
              "node_name": {
                "aggregations": [],
                "operation": "groupby"
              },
              "zone": {
                "aggregations": ["uniqueValues"],
                "operation": "aggregate"
              }
            }
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "node_name": "Node",
              "zone (uniqueValues)": "Available Measurement Types"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 32
      },
      "id": 103,
      "panels": [],
      "title": "Cluster Node Information",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays detailed CPU information for each monitored node, including the CPU model and number of cores. This helps understand the hardware capabilities of each node.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 33
      },
      "id": 203,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": ["sum"],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "count by (instance, model_name)(kepler_node_cpu_info{job=\"$job\"})",
          "format": "table",
          "instant": true,
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Node CPU Configuration",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": false
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "CPU Cores",
              "instance": "Node",
              "model_name": "CPU Model"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows the current power consumption broken down by measurement zone (psys, package, dram) for each selected node. This table helps identify which power zones are consuming the most energy.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 42
      },
      "id": 200,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": ["sum"],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "sum by (zone,node_name) (kepler_node_cpu_watts{job=\"$job\", zone=~\"$zone\",node_name=~\"$node\"})",
          "format": "table",
          "instant": true,
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Current Power Usage By Zone",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Power(W)",
              "node_name": "Node",
              "zone": "Zone"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays the power being consumed by active workloads for each measurement zone on the selected node. This shows how much power is directly attributable to computational work in each zone.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 42
      },
      "id": 201,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": ["sum"],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "sum by (zone,node_name) (kepler_node_cpu_active_watts{job=\"$job\", zone=~\"$zone\",node_name=~\"$node\"})",
          "format": "table",
          "instant": true,
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Active Workload Power Usage by Zone",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Power(W)",
              "node_name": "Node",
              "zone": "Zone"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows the baseline idle power consumption for each measurement zone on the selected node. This represents the power consumed when the node is not actively processing workloads.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 42
      },
      "id": 202,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": ["sum"],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "sum by (zone,node_name) (kepler_node_cpu_idle_watts{job=\"$job\", zone=~\"$zone\",node_name=~\"$node\"})",
          "format": "table",
          "instant": true,
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Idle Power Usage By Zone",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Power(W)",
              "node_name": "Node",
              "zone": "Zone"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 50
      },
      "id": 104,
      "panels": [],
      "title": "Power Consumption by Node",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Lists the five nodes with the highest average power consumption over the selected time range. Use this to quickly identify which nodes are consuming the most energy in your cluster.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 51
      },
      "id": 220,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": ["sum"],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "topk(5,\n  avg_over_time(\n    # Sum all valid power components by node\n    sum by (node_name) (\n      (\n        # A.1: Get PSYS values from PSYS nodes\n        kepler_node_cpu_watts{zone=\"psys\"}\n      )\n      or\n      (\n        # A.2: Get PACKAGE values from non-PSYS nodes\n        kepler_node_cpu_watts{zone=\"package\"}\n        unless on(node_name)\n        kepler_node_cpu_watts{zone=\"psys\"}\n      )\n      or\n      (\n        # Part B: Get DRAM values from ALL nodes\n        kepler_node_cpu_watts{zone=\"dram\"}\n      )\n    )[$__range:]\n  ) > 0\n)",
          "format": "table",
          "instant": true,
          "legendFormat": "{{label_name}}",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Top 5 Nodes by Power Usage",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Power(W)",
              "node_name": "Node"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays a time-series graph of power consumption for the selected node, showing trends for total power, active power, and idle power over time. This helps identify patterns and anomalies in node power usage.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "graph": false,
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 51
      },
      "id": 204,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "mean"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# Get total power for the selected node(s)\nsum(\n  (\n    # A.1: Get PSYS value from PSYS nodes\n    kepler_node_cpu_watts{job=\"$job\", zone=\"psys\", node_name=~\"$node\"}\n  )\n  or\n  (\n    # A.2: Get PACKAGE value from non-PSYS nodes\n    kepler_node_cpu_watts{job=\"$job\", zone=\"package\", node_name=~\"$node\"}\n    unless on(node_name)\n    kepler_node_cpu_watts{job=\"$job\", zone=\"psys\", node_name=~\"$node\"}\n  )\n  or\n  (\n    # Part B: Get DRAM value from ALL nodes\n    kepler_node_cpu_watts{job=\"$job\", zone=\"dram\", node_name=~\"$node\"}\n  )\n) or vector(0)",
          "hide": false,
          "interval": "",
          "legendFormat": "$node - Total Power",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# Get total power for the selected node(s)\nsum(\n  (\n    # A.1: Get PSYS value from PSYS nodes\n    kepler_node_cpu_active_watts{job=\"$job\", zone=\"psys\", node_name=~\"$node\"}\n  )\n  or\n  (\n    # A.2: Get PACKAGE value from non-PSYS nodes\n    kepler_node_cpu_active_watts{job=\"$job\", zone=\"package\", node_name=~\"$node\"}\n    unless on(node_name)\n    kepler_node_cpu_active_watts{job=\"$job\", zone=\"psys\", node_name=~\"$node\"}\n  )\n  or\n  (\n    # Part B: Get DRAM value from ALL nodes\n    kepler_node_cpu_active_watts{job=\"$job\", zone=\"dram\", node_name=~\"$node\"}\n  )\n) or vector(0)",
          "hide": false,
          "instant": false,
          "legendFormat": "$node - Active Power",
          "range": true,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "# Get total power for the selected node(s)\nsum(\n  (\n    # A.1: Get PSYS value from PSYS nodes\n    kepler_node_cpu_idle_watts{job=\"$job\", zone=\"psys\", node_name=~\"$node\"}\n  )\n  or\n  (\n    # A.2: Get PACKAGE value from non-PSYS nodes\n    kepler_node_cpu_idle_watts{job=\"$job\", zone=\"package\", node_name=~\"$node\"}\n    unless on(node_name)\n    kepler_node_cpu_idle_watts{job=\"$job\", zone=\"psys\", node_name=~\"$node\"}\n  )\n  or\n  (\n    # Part B: Get DRAM value from ALL nodes\n    kepler_node_cpu_idle_watts{job=\"$job\", zone=\"dram\", node_name=~\"$node\"}\n  )\n) or vector(0)",
          "hide": false,
          "instant": false,
          "legendFormat": "$node - Idle Power",
          "range": true,
          "refId": "C"
        }
      ],
      "title": "Power Usage Trends for Node",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows a detailed time-series breakdown of power consumption by measurement zone (psys, package, dram) for the selected node. This helps understand which hardware components are consuming power over time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "graph": false,
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 8,
        "x": 0,
        "y": 59
      },
      "id": 205,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "kepler_node_cpu_watts{job=\"$job\", instance=~\"$node\", zone=~\"$zone\"}",
          "hide": false,
          "interval": "",
          "legendFormat": "{{instance}} - {{zone}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Selected Node Power Breakdown",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays a time-series graph showing the active workload power consumption broken down by measurement zone for the selected node. This tracks how much power is being used for actual computational work in each zone.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "graph": false,
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 8,
        "x": 8,
        "y": 59
      },
      "id": 206,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "kepler_node_cpu_active_watts{job=\"$job\", instance=~\"$node\", zone=~\"$zone\"}",
          "hide": false,
          "interval": "",
          "legendFormat": "{{instance}} - {{zone}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Selected Node Active Workload Power",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows a time-series graph of idle power consumption by measurement zone for the selected node. This tracks the baseline power consumption when the node is not actively processing workloads.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "graph": false,
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 8,
        "x": 16,
        "y": 59
      },
      "id": 207,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "kepler_node_cpu_idle_watts{job=\"$job\", instance=~\"$node\", zone=~\"$zone\"}",
          "hide": false,
          "interval": "",
          "legendFormat": "{{instance}} - {{zone}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Selected Node Idle Power",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 69
      },
      "id": 105,
      "panels": [],
      "title": "Namespace and Workload Power Usage",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Lists the ten namespaces with the highest average power consumption over the selected time range, aggregated across all nodes and measurement zones. This helps identify which namespaces are consuming the most energy in your cluster.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 12,
        "x": 0,
        "y": 70
      },
      "id": 208,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "enablePagination": true,
          "fields": "",
          "reducer": [],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "topk(10,\n  # Step 2: Sum the average pod power by namespace\n  sum by (pod_namespace) (\n    avg_over_time(\n      # Step 1: Sum all valid power components by pod\n      sum by (pod_namespace, pod_name) (\n        (\n          # A.1: Get PSYS attributions from pods on PSYS nodes\n          kepler_pod_cpu_watts{job=\"$job\", zone=\"psys\"}\n          and on(node_name)\n          kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}\n        )\n        or\n        (\n          # A.2: Get PACKAGE attributions from pods on non-PSYS nodes\n          kepler_pod_cpu_watts{job=\"$job\", zone=\"package\"}\n          unless on(node_name)\n          kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}\n        )\n        or\n        (\n          # Part B: Get DRAM power from ALL nodes\n          kepler_pod_cpu_watts{job=\"$job\", zone=\"dram\"}\n        )\n      )[$__range:]\n    )\n  ) > 0\n)",
          "format": "table",
          "instant": true,
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Top 10 Power Consuming Namespaces",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Power (W)",
              "pod_namespace": "Namespace"
            }
          }
        },
        {
          "id": "sortBy",
          "options": {
            "fields": {},
            "sort": [
              {
                "desc": true,
                "field": "Power Consumption"
              }
            ]
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Lists the ten pods with the highest average power consumption over the selected time range. Shows both the namespace and pod name to help identify which specific workloads are consuming the most energy.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 12,
        "x": 12,
        "y": 70
      },
      "id": 221,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "enablePagination": true,
          "fields": "",
          "reducer": ["sum"],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Power (W)"
          }
        ]
      },
      "pluginVersion": "10.4.3",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "topk(10,\n  avg_over_time(\n    # Sum all valid power components by pod\n    sum by (pod_namespace, pod_name) (\n      (\n        # A.1: Get PSYS attributions from pods on PSYS nodes\n        kepler_pod_cpu_watts{job=\"$job\", zone=\"psys\"}\n        and on(node_name)\n        kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}\n      )\n      or\n      (\n        # A.2: Get PACKAGE attributions from pods on non-PSYS nodes\n        kepler_pod_cpu_watts{job=\"$job\", zone=\"package\"}\n        unless on(node_name)\n        kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}\n      )\n      or\n      (\n        # Part B: Get DRAM power from ALL nodes\n        kepler_pod_cpu_watts{job=\"$job\", zone=\"dram\"}\n      )\n    )[$__range:]\n  ) > 0\n)",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Top 10 Pods by Power Usage",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Power (W)",
              "pod_name": "Pod",
              "pod_namespace": "Namespace"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Displays a time-series graph of power consumption for all pods in the selected namespace. Each line represents a different pod, allowing you to compare power usage across workloads within the namespace over time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "graph": false,
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 0,
        "y": 82
      },
      "id": 209,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "mean"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "sum by (pod_namespace, pod_name) (\n  (\n    # A.1: Get PSYS attributions from pods on PSYS nodes\n    # This is the \"SoC\" power for Node 2\n    kepler_pod_cpu_watts{job=\"$job\", zone=\"psys\", pod_namespace=~\"$namespace\"}\n    and on(node_name)\n    kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}\n  )\n  or\n  (\n    # A.2: Get PACKAGE attributions from pods on non-PSYS nodes\n    # This is the \"SoC\" power for Node 1 and Node 3\n    kepler_pod_cpu_watts{job=\"$job\", zone=\"package\", pod_namespace=~\"$namespace\"}\n    unless on(node_name)\n    kepler_node_cpu_watts{job=\"$job\", zone=\"psys\"}\n  )\n  or\n  (\n    # Part B: Get DRAM power from ALL nodes\n    # This adds the \"DRAM\" component for Node 1 and Node 3\n    kepler_pod_cpu_watts{job=\"$job\", zone=\"dram\", pod_namespace=~\"$namespace\"}\n  )\n)",
          "hide": false,
          "interval": "",
          "legendFormat": "{{pod_namespace}} - {{pod_name}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Power Usage Trends for Namespace",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Shows a detailed time-series breakdown of power consumption by measurement zone for the selected pod(s) in the namespace. This helps understand which hardware components are consuming power for specific workloads.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "graph": false,
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 12,
        "y": 82
      },
      "id": 210,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "mean"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "kepler_pod_cpu_watts{job=\"$job\", pod_namespace=~\"$namespace\", pod_name=~\"$pod\", zone=~\"$zone\"}",
          "hide": false,
          "interval": "",
          "legendFormat": "{{pod_name}} - {{zone}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Selected Namespace Power Breakdown",
      "type": "timeseries"
    }
  ],
  "refresh": "10s",
  "schemaVersion": 39,
  "tags": ["power-monitor-mixin"],
  "templating": {
    "list": [
      {
        "current": {
          "selected": false,
          "text": "prometheus",
          "value": "${datasource}"
        },
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "datasource",
        "options": [],
        "query": "prometheus",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "allValue": ".*",
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values(kepler_node_cpu_info{job=\"$job\"}, instance)",
        "description": "Node to choose",
        "hide": 0,
        "includeAll": false,
        "label": "Node",
        "multi": false,
        "name": "node",
        "options": [],
        "query": "label_values(kepler_node_cpu_info{job=\"$job\"}, instance)",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": ".*",
        "current": {
          "selected": false,
          "text": "All",
          "value": "$__all"
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values(kepler_node_cpu_watts{job=\"$job\"}, zone)",
        "description": "Zone to choose",
        "hide": 0,
        "includeAll": true,
        "label": "Zone",
        "multi": false,
        "name": "zone",
        "options": [],
        "query": "label_values(kepler_node_cpu_watts{job=\"$job\"}, zone)",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": ".*",
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values(kepler_pod_cpu_watts{job=\"$job\"}, pod_namespace)",
        "description": "Namespace to choose",
        "hide": 0,
        "includeAll": false,
        "label": "Namespace",
        "multi": false,
        "name": "namespace",
        "options": [],
        "query": "label_values(kepler_pod_cpu_watts{job=\"$job\"}, pod_namespace)",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": ".*",
        "current": {
          "selected": false,
          "text": "All",
          "value": "$__all"
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values(kepler_pod_cpu_watts{job=\"$job\", pod_namespace=~\"$namespace\"},pod_name)",
        "description": "Pod to choose",
        "hide": 0,
        "includeAll": true,
        "label": "Pod",
        "multi": false,
        "name": "pod",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values(kepler_pod_cpu_watts{job=\"$job\", pod_namespace=~\"$namespace\"},pod_name)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": ".*",
        "current": {
          "selected": false,
          "text": "power-monitor",
          "value": "power-monitor"
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values(kepler_pod_cpu_watts,job)",
        "description": "Job to choose",
        "hide": 0,
        "includeAll": false,
        "label": "Job",
        "multi": false,
        "name": "job",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values(kepler_pod_cpu_watts,job)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      }
    ]
  },
  "time": {
    "from": "now-15m",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "Power Monitor Dashboard",
  "uid": "381ef848417532a1ef945494449453a41fdabaa7",
  "version": 42,
  "weekStart": ""
}
